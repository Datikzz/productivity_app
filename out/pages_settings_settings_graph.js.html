<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/settings/settings_graph.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/settings/settings_graph.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Render graph on settings page
 * @namespace renderGraph
 */
export function renderGraph() {
  const workTimeItem = document.getElementById('workTime-value');
  const shortBreakItem = document.getElementById('shortBreak-value');
  const longBreakItem = document.getElementById('longBreak-value');
  const iterItem = document.getElementById('iteration-value');

  if(workTimeItem &amp;&amp; shortBreakItem &amp;&amp; longBreakItem &amp;&amp; iterItem){
    render();
    window.addEventListener('resize', render);
  }
  /**
   * Create setting item
   * @param {object} options - The object containing values for new setting item
   * @constructor Voter
   * @memberOf renderGraph
   */
  function Voter(options){
    let elem = options.elem;
    let step = options.step;
    let min = options.min;
    let max = options.max;
    let voteElem = options.voteElem;
    let graphElem = options.graphElem;
    elem.addEventListener('click',(event) => {
      if(event.target.closest('.minus-btn')){
        voteDecrease();
      }
      else if(event.target.closest('.plus-btn')){
        voteIncrease();
      }
      render();
    });
    elem.addEventListener('mousedown', () => {
      return false;
    });
    /**
     * Decrease setting value
     */
    function voteDecrease(){
      if(+voteElem.innerText &lt; step) return;
      if(+voteElem.innerText > min){
        voteElem.innerText  = parseInt(voteElem.innerText, 10) - step;
      }
    }
    /**
     * Increase setting value
     */
    function voteIncrease(){
      if(+voteElem.innerHTML &lt; max){
        voteElem.innerText  = parseInt(voteElem.innerText, 10) + step;
      }
    }
  }

  /**
   * Render graph lines
   * @memberOf renderGraph
   */
  function render() {
    const ctnWidth = document.getElementsByClassName('graph-ctn')[0];
    const settings = JSON.parse(localStorage.getItem('settings'));
    let workTimeVal = +workTimeItem.innerText;
    let shortBreakVal = +shortBreakItem.innerText;
    let longBreakVal = +longBreakItem.innerText;
    let iterVal = +iterItem.innerText;
    let time = (workTimeVal*(iterVal*2))+(shortBreakVal*((iterVal*2)-2))+longBreakVal;
    let firstCycle = (workTimeVal*iterVal)+(shortBreakVal*(iterVal-1))+longBreakVal;
    const timePoint = document.getElementsByClassName('timePoint');
    const workTimeLine = document.getElementsByClassName('workTime-line');
    const shortBreakLine = document.getElementsByClassName('shortBreak-line');
    const longBreakLine = document.getElementsByClassName('longBreak-line');
    const iterationLine = document.getElementsByClassName('iteration-line');

    for (let i = 0; i &lt; workTimeLine.length; i++) {
      workTimeLine[i].style.width = ((ctnWidth.offsetWidth * workTimeVal)) / time + 'px';
    }
    for (let i = 0; i &lt; shortBreakLine.length; i++) {
      shortBreakLine[i].style.width = ((ctnWidth.offsetWidth*shortBreakVal))/time+'px';
    }
    for (let i = 0; i &lt; timePoint.length; i++) {
      timePoint[i].style.marginLeft = ((ctnWidth.offsetWidth*30))/time+'px';
    }
    longBreakLine[0].style.width = ((ctnWidth.offsetWidth*longBreakVal)/time)+'px';

    const endTime = document.getElementsByClassName('endTime')[0];
    const phaseTime = document.getElementsByClassName('phaseTime')[0];
    endTime.innerText= convertMinsToHrsMins(time);
    endTime.innerHTML+=`&lt;br>&lt;span class='marker'>.&lt;/span>`;
    phaseTime.innerText= 'First cycle: '+convertMinsToHrsMins(firstCycle);
    phaseTime.innerHTML+=`&lt;br>&lt;span class='marker'>.&lt;/span>`;
    phaseTime.style.left = iterationLine[iterationLine.length/2].offsetLeft+'px';
  }

  /**
   * Convent minutes to format Hours:Minutes
   * @param {number} time - the minutes value
   * @returns {string} The converted time string
   */
  function convertMinsToHrsMins(time) {
    let h = Math.floor(time / 60);
    let m = time % 60;
    m = m &lt; 10 ? '0' + m : m;
    return h+'h:'+m+'m';
  }

  let workTime = new Voter({
    elem: document.getElementById('workTime-voter'),
    step: 5,
    min: 15,
    max: 25,
    voteElem: document.getElementById('workTime-value'),
    graphElem: document.getElementsByClassName('workTime-line')
  });

  let shortBreak = new Voter({
    elem: document.getElementById('shortBreak-voter'),
    step: 1,
    min: 3,
    max: 5,
    voteElem: document.getElementById('shortBreak-value'),
    graphElem: document.getElementsByClassName('shortBreak-line')
  });

  let longBreak = new Voter({
    elem: document.getElementById('longBreak-voter'),
    step: 5,
    min: 15,
    max: 30,
    voteElem: document.getElementById('longBreak-value'),
    graphElem: document.getElementsByClassName('longBreak-line')
  });

  /**
   * Create iteration setting item
   * @param {object} options - The object containing values for iteration setting item
   * @constructor VoterIter
   */
  function VoterIter(options) {
    let elem = options.elem;
    let step = options.step;
    let min = options.min;
    let max = options.max;
    let voteElem = options.voteElem;
    let graphElem = options.graphElem;

    elem.addEventListener('click', (event) => {
      if (event.target.closest('.minus-btn')) {
        voteDecrease();
      }
      else if (event.target.closest('.plus-btn')) {
        voteIncrease();
      }
      render();
    });
    elem.addEventListener('mousedown', () => {
      return false;
    });
    let graphCtn = document.getElementsByClassName('graph-ctn')[0];
    /**
     * Decrease setting value
     * @memberOf Settings
     */
    function voteDecrease() {

      let listLength = graphElem.length;
      if (+voteElem.innerHTML &lt; step) return;
      if (+voteElem.innerHTML > min) {
        voteElem.innerHTML = parseInt(voteElem.innerHTML, 10) - step;
        graphCtn.removeChild(graphElem[listLength-1]);
        graphCtn.removeChild(graphElem[0]);
      }
    }
    /**
     * Increase setting value
     * @memberOf Settings
     */
    function voteIncrease() {
      let listLength = graphElem.length;
      if (+voteElem.innerHTML &lt; max) {
        voteElem.innerHTML = parseInt(voteElem.innerHTML, 10) + step;
        const newIter = document.createElement('div');
        newIter.className = 'iteration-line';
        newIter.innerHTML+=`&lt;div class='workTime-line'>&lt;/div>&lt;div class='shortBreak-line'>&lt;/div>`;
        const newIterLast = document.createElement('div');
        newIterLast.className = 'iteration-line';
        newIterLast.innerHTML+=`&lt;div class='shortBreak-line'>&lt;/div>&lt;div class='workTime-line'>&lt;/div>`;
        graphCtn.appendChild(newIterLast);
        graphCtn.insertBefore(newIter,graphCtn.firstChild);
      }
    }
  }

  let iteration = new VoterIter({
    elem: document.getElementById('iteration-voter'),
    step: 1,
    min: 2,
    max: 5,
    voteElem: document.getElementById('iteration-value'),
    graphElem: document.getElementsByClassName('iteration-line')
  });
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="EventBus.EventBus.html">EventBus</a></li><li><a href="Firebase.Firebase.html">Firebase</a></li><li><a href="Modal.Modal.html">Modal</a></li><li><a href="renderGraph.Voter.html">Voter</a></li><li><a href="Router.Router.html">Router</a></li><li><a href="Settings.Settings.html">Settings</a></li><li><a href="TaskModel.module.exports.html">module.exports</a></li><li><a href="TaskModel.TaskModel.html">TaskModel</a></li><li><a href="Timer.Timer.html">Timer</a></li><li><a href="VoterIter.html">VoterIter</a></li></ul><h3>Namespaces</h3><ul><li><a href="EventBus.html">EventBus</a></li><li><a href="Firebase.html">Firebase</a></li><li><a href="Modal.html">Modal</a></li><li><a href="renderGraph.html">renderGraph</a></li><li><a href="Router.html">Router</a></li><li><a href="Settings.html">Settings</a></li><li><a href="TaskModel.html">TaskModel</a></li><li><a href="Timer.html">Timer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#highlight">highlight</a></li><li><a href="global.html#renderChart">renderChart</a></li><li><a href="global.html#renderReportTempl">renderReportTempl</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jan 15 2018 23:41:15 GMT+0200 (FLE Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
